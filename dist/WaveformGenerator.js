"use strict";var WaveformGenerator=function(t,e){function a(){return"a"+Math.floor(65536*(1+Math.random())).toString(16).substring(1)+"b"+Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function r(t,e){var a=d.bar.width;0!==d.bar.gap&&(a*=Math.abs(100-d.bar.gap)/100);var r,o=t+a/2;switch(d.bar.align){case"top":r=0;break;case"center":r=d.waveform.height/2-e/2;break;case"bottom":r=d.waveform.height-e}if("png"===d.drawMode){var n=u.getContext("2d");n.fillStyle=d.waveform.color,n.fillRect(o,r,a,e)}else if("svg"===d.drawMode){var i=document.createElement("path");i.setAttribute("d","M"+o+" "+r+" L"+o+" "+r+" L"+o+" "+(r+e)+" L"+o+" "+(r+e)+" L"+o+" "+r+" Z"),i.className=l.id,l.appendChild(i)}}function o(t,e,a){for(var r=0,o=t,n=t+e-1;n>=t?n>=o:o>=n;n>=t?o++:o--)r+=Math.pow(a[o],2);return Math.sqrt(r/a.length)}function n(t){t=t.getChannelData(0);for(var e=d.waveform.width,a=Math.floor(t.length/e),n=d.waveform.height,i=[],h=0;e>h;h+=d.bar.width)i.push(1e4*o(h*a,a,t));for(var l=n/Math.max.apply(null,i),s=0;e>s;s+=d.bar.width){var u=1e4*o(s*a,a,t);u*=l,u+=1,r(s,u)}return h>=e?!0:void 0}function i(t,e){return Object.assign(d,e),l=document.createElement("svg"),l.id=a(),l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("version","1.1"),l.setAttributeNS(null,"viewBox","0 0 "+d.waveform.width+" "+d.waveform.height),s=document.createElement("style"),s.setAttribute("type","text/css"),s.appendChild(document.createTextNode("<![CDATA[path."+l.id+"{stroke:"+d.waveform.color+";stroke-width:"+(0!==d.bar.width?d.bar.width*Math.abs(1-d.bar.gap):d.bar.width)+"}]]>")),l.appendChild(s),new Promise(function(e,a){h.decodeAudioData(t,function(t){n(t)&&e(l.outerHTML)})})}var d={waveform:{width:500,height:80,color:"#bada55"},bar:{align:"center",width:1,gap:0},drawMode:"png"},h=new AudioContext||new WebkitAudioContext,l=null,s=null,u=document.createElement("canvas");return i}();
//# sourceMappingURL=WaveformGenerator.js.map
